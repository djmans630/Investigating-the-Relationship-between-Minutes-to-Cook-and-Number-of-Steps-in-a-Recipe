# Investigating the Relationship between Minutes to Cook and Number of Steps in a Recipe
### By Daniel Mansperger
---


## Introduction


The data I will use for my project is a set of recipes and several characteristics  
about each one. One example of a recipe can be found here: 
[Chickpea and Fresh Tomato Toss Recipe - Food.com.](https://www.food.com/recipe/chickpea-and-fresh-tomato-toss-51631) 
The dataset itself contains tens of thousands of recipes.  

I begin with two dataframes, which I call `recipes` and `interactions`. `recipes`  
contains information about the characteristics of each recipe, and `interactions`  
contains ratings and reviews for each recipe. Luckily for me, they each contain a  
column for recipe ID’s, which are unique identifiers. Using a left merge (where  
`recipes` is the left dataframe), I merge the information of the two datasets and  
ensure that there is information about all recipes available, even those that  
don’t have review information. I call this dataframe that results from the merge  
`df`, and it will be foundational moving forward.  

Using this data, I will attempt to answer this question: What is the relationship  
between cooking time in minutes and the number of steps and ingredients a recipe  
has? Moving forward, I will develop a prediction model that attempts to predict  
the number of minutes a recipe will take to cook, based on these features and  
more. I believe this question is worth investigating because the number of  
ingredients and steps are two of the most important characteristics when deciding  
on a recipe, as is the time it will take to complete. Based on intuition, I  
believe there is a relationship between these characteristics, and because of  
that I may be able to determine this important information reliably, and be able  
to evaluate the truth behind the specifics of a recipe’s claimed time to complete.  
Should this be the case, potential chefs can have more information at their  
disposal to help them decide on a recipe that meets their desired time criteria.  

Before any EDA or cleaning, `df` has 234,429 rows (recipes, with some duplicates  
for multiple people reviewing the same recipe) and 15 columns. Some of these  
columns will be very important for analysis moving forward. The three that I have  
mentioned before are `n_steps`, `n_ingredients`, and `minutes`. `n_steps` is a  
column of integers representing the number of steps in a recipe. Similarly,  
`n_ingredients` is the number of ingredients in a recipe. These are based off of  
the `steps` and `ingredients` columns, respectively, each of which initially  
contain lists of strings of the steps and ingredients of recipes, also  
respectively, though initially the lists in both columns are represented as  
strings where the contents are lists of strings. The `minutes` column is also  
composed of integers, each of which represents the expected number of minutes it  
will take to complete a recipe. Other columns that may be of interest are  
`recipe_id` (containing integers that are unique for each recipe), `name`  
(containing strings representing recipe names), `tags` (containing lists of short  
string tags of information about the recipe, similar to hashtags), `nutrition`  
(containing strings that evaluate to lists of nutrition information about the  
recipe, with each list having the form “[calories (#), total fat (PDV), sugar  
(PDV), sodium (PDV), protein (PDV), saturated fat (PDV), carbohydrates (PDV)]”,  
where PDV stands for “percentage of daily value”), `description` (containing  
strings of the original poster’s description of the recipe), and `rating`  
(containing floats representing a star rating from 1.0 to 5.0). Other columns  
that are not as important to my analysis but are still important in the dataset  
are `date` (for dates), `user_id` (for unique user identification), `avg_rating`  
(a column I added that contains the average ratings of each recipe), and `review`  
(containing someone’s string review of a recipe).



## Data Cleaning and Exploratory Data Analysis
To get a better understanding of the data, I first did a little Exploratory Data
Analysis (EDA). The first thing I checked was the number of missing values in 
each column. There was one recipe missing a name, 114 missing descriptions, 
15,036 missing ratings, 58 missing reviews, and 2,777 missing average ratings. 
All other columns had no missing values. One conclusion I draw from this is 
that some ratings are missing where average ratings exist, which means that 
some people just don’t provide ratings, even on what they may leave a review on 
considering the significantly less missing values in the review column. It 
should be noted that before I looked at any of these missing values, I replaced 
all of the ratings of 0.0 with `np.nan`. The reason for this is that you can 
only provide a rating between 1 and 5 stars for a recipe, so any rating of 0.0 
in the dataset is actually missing and should be treated as such. However, this 
was not the only column that required cleaning, and in my EDA and cleaning, I 
addressed these issues.

The date column was originally composed of strings, and to more easily work 
with the datetime aspects of these values, I opted to convert each entry to 
`pd.datetime` objects, as the form of each date string was consistent. This 
column now contains datetime objects with a day, month, and year of user 
interaction with a recipe.

The nutrition column was one of those composed of strings that contain lists, 
so I applied `eval` to extract those lists. Afterwards, I thought it would be 
easier to work with proportions of daily value rather than percentages, so I 
converted all of the PDV values (all except calories) in accordance. Each 
element of this column is now a list of the form `[calories, total fat, sugar, 
sodium, protein, saturated fat, carbohydrates]`, where all entries except for 
calories are proportions of daily value.

The steps and ingredients columns were similarly composed of strings containing 
lists, so I once again applied `eval` to both of them. Since their lists were 
only composed of text details, this was all I needed to do for these columns, 
which now contain lists of strings representing steps and ingredients, 
respectively.

I then came to the minutes column, which required special consideration. I knew 
I was going to use this column for analysis and prediction moving forward, so I 
needed to make sure I had good information. I noticed that many values were 
actually very high in the minutes column, even going as far as over one million 
minutes! I wanted to limit the recipes I analyzed to those that take less than 
a day to cook. Many recipes are much longer than that, but generally they 
represent recipes for ingredients or require special aging for extended periods 
of time. To accomplish this, of course I would limit the recipes to those that 
take less than a day. But believing I could narrow it down more, I did a little 
outside research. According to [Smoking Times and Temperatures Chart for Beef, 
Pork & Poultry](https://www.smoking-meat.com/smoking-times-and-temperatures-
chart), recipes that can be completed in one day can take anywhere from less 
than an hour to up to 20 hours! Taking the average of these times listed, I get 
about 5 hours, which is around what I wanted because I wanted to filter to only 
include the cooking times of “standing” recipes, or those that could be 
completed in one standing without much downtime. So, I took this to be my 
"minute-limit" on cooking times. 5 hours in minutes is 300 minutes, and as such 
I filtered my dataframe to only include those rows where minutes to cook were 
less than or equal to 300. One other consideration I had to help me filter for 
standing recipes was to use the columns involving text and filter by certain 
keywords. I chose to avoid doing this because some appetizers/snacks certainly 
should be included due to longer cooking times, and in other instances names 
and reviews may include words like "drink" or "wine" because the recipe pairs 
well with these things. As such, I will only filter by time in minutes.

After these cleaning steps are taken, here is a look at the head of my cleaned 
dataframe:

| name                                 |   recipe_id |   minutes |   user_id | date                | tags                                                                                                                                                                                                                        | nutrition                                                                                                                       |   n_steps | steps                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | description                                                                                                                                                                                                                                                                                                                                                                       | ingredients                                                                                                                                                                    |   n_ingredients |   rating | review                                                                                                                                                                                                                                                                                                                                           |   avg_rating |
|:-------------------------------------|------------:|----------:|----------:|:--------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------|----------:|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------:|---------:|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------:|
| 1 brownies in the world    best ever |      333281 |        40 |    985201 | 2008-10-27 00:00:00 | ['60-minutes-or-less', 'time-to-make', 'course', 'main-ingredient', 'preparation', 'for-large-groups', 'desserts', 'lunch', 'snacks', 'cookies-and-brownies', 'chocolate', 'bar-cookies', 'brownies', 'number-of-servings'] | [np.float64(138.4), np.float64(0.1), np.float64(0.5), np.float64(0.03), np.float64(0.03), np.float64(0.19), np.float64(0.06)]   |        10 | ['heat the oven to 350f and arrange the rack in the middle', 'line an 8-by-8-inch glass baking dish with aluminum foil', 'combine chocolate and butter in a medium saucepan and cook over medium-low heat , stirring frequently , until evenly melted', 'remove from heat and let cool to room temperature', 'combine eggs , sugar , cocoa powder , vanilla extract , espresso , and salt in a large bowl and briefly stir until just evenly incorporated', 'add cooled chocolate and mix until uniform in color', 'add flour and stir until just incorporated', 'transfer batter to the prepared baking dish', 'bake until a tester inserted in the center of the brownies comes out clean , about 25 to 30 minutes', 'remove from the oven and cool completely before cutting']                                                  | these are the most; chocolatey, moist, rich, dense, fudgy, delicious brownies that you'll ever make.....sereiously! there's no doubt that these will be your fav brownies ever for you can add things to them or make them plain.....either way they're pure heaven!                                                                                                              | ['bittersweet chocolate', 'unsalted butter', 'eggs', 'granulated sugar', 'unsweetened cocoa powder', 'vanilla extract', 'brewed espresso', 'kosher salt', 'all-purpose flour'] |               9 |        4 | These were pretty good, but took forever to bake.  I would send it ended up being almost an hour!  Even then, the brownies stuck to the foil, and were on the overly moist side and not easy to cut.  They did taste quite rich, though!  Made for My 3 Chefs.                                                                                   |            4 |
| 1 in canada chocolate chip cookies   |      453467 |        45 |   1848091 | 2011-04-11 00:00:00 | ['60-minutes-or-less', 'time-to-make', 'cuisine', 'preparation', 'north-american', 'for-large-groups', 'canadian', 'british-columbian', 'number-of-servings']                                                               | [np.float64(595.1), np.float64(0.46), np.float64(2.11), np.float64(0.22), np.float64(0.13), np.float64(0.51), np.float64(0.26)] |        12 | ['pre-heat oven the 350 degrees f', 'in a mixing bowl , sift together the flours and baking powder', 'set aside', 'in another mixing bowl , blend together the sugars , margarine , and salt until light and fluffy', 'add the eggs , water , and vanilla to the margarine / sugar mixture and mix together until well combined', 'add in the flour mixture to the wet ingredients and blend until combined', 'scrape down the sides of the bowl and add the chocolate chips', 'mix until combined', 'scrape down the sides to the bowl again', 'using an ice cream scoop , scoop evenly rounded balls of dough and place of cookie sheet about 1 - 2 inches apart to allow for spreading during baking', 'bake for 10 - 15 minutes or until golden brown on the outside and soft & chewy in the center', 'serve hot and enjoy !'] | this is the recipe that we use at my school cafeteria for chocolate chip cookies. they must be the best chocolate chip cookies i have ever had! if you don't have margarine or don't like it, then just use butter (softened) instead.                                                                                                                                            | ['white sugar', 'brown sugar', 'salt', 'margarine', 'eggs', 'vanilla', 'water', 'all-purpose flour', 'whole wheat flour', 'baking soda', 'chocolate chips']                    |              11 |        5 | Originally I was gonna cut the recipe in half (just the 2 of us here), but then we had a park-wide yard sale, & I made the whole batch & used them as enticements for potential buyers ~ what the hey, a free cookie as delicious as these are, definitely works its magic! Will be making these again, for sure! Thanks for posting the recipe! |            5 |
| 412 broccoli casserole               |      306168 |        40 |     50969 | 2008-05-30 00:00:00 | ['60-minutes-or-less', 'time-to-make', 'course', 'main-ingredient', 'preparation', 'side-dishes', 'vegetables', 'easy', 'beginner-cook', 'broccoli']                                                                        | [np.float64(194.8), np.float64(0.2), np.float64(0.06), np.float64(0.32), np.float64(0.22), np.float64(0.36), np.float64(0.03)]  |         6 | ['preheat oven to 350 degrees', 'spray a 2 quart baking dish with cooking spray , set aside', 'in a large bowl mix together broccoli , soup , one cup of cheese , garlic powder , pepper , salt , milk , 1 cup of french onions , and soy sauce', 'pour into baking dish , sprinkle remaining cheese over top', 'bake for 25 minutes or until cheese is lightly browned', 'sprinkle with rest of french fried onions and bake until onions are browned and cheese is bubbly , about 10 more minutes']                                                                                                                                                                                                                                                                                                                              | since there are already 411 recipes for broccoli casserole posted to "zaar" ,i decided to call this one  #412 broccoli casserole.i don't think there are any like this one in the database. i based this one on the famous "green bean casserole" from campbell's soup. but i think mine is better since i don't like cream of mushroom soup.submitted to "zaar" on may 28th,2008 | ['frozen broccoli cuts', 'cream of chicken soup', 'sharp cheddar cheese', 'garlic powder', 'ground black pepper', 'salt', 'milk', 'soy sauce', 'french-fried onions']          |               9 |        5 | This was one of the best broccoli casseroles that I have ever made.  I made my own chicken soup for this recipe. I was a bit worried about the tsp of soy sauce but it gave the casserole the best flavor. YUM!                                                                                                                                  |            5 |
|                                      |             |           |           |                     |                                                                                                                                                                                                                             |                                                                                                                                 |           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                |                 |          | The photos you took (shapeweaver) inspired me to make this recipe and it actually does look just like them when it comes out of the oven.                                                                                                                                                                                                        |              |
|                                      |             |           |           |                     |                                                                                                                                                                                                                             |                                                                                                                                 |           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                |                 |          | Thanks so much for sharing your recipe shapeweaver. It was wonderful!  Going into my family's favorite Zaar cookbook :)                                                                                                                                                                                                                          |              |
| 412 broccoli casserole               |      306168 |        40 |     50969 | 2008-05-30 00:00:00 | ['60-minutes-or-less', 'time-to-make', 'course', 'main-ingredient', 'preparation', 'side-dishes', 'vegetables', 'easy', 'beginner-cook', 'broccoli']                                                                        | [np.float64(194.8), np.float64(0.2), np.float64(0.06), np.float64(0.32), np.float64(0.22), np.float64(0.36), np.float64(0.03)]  |         6 | ['preheat oven to 350 degrees', 'spray a 2 quart baking dish with cooking spray , set aside', 'in a large bowl mix together broccoli , soup , one cup of cheese , garlic powder , pepper , salt , milk , 1 cup of french onions , and soy sauce', 'pour into baking dish , sprinkle remaining cheese over top', 'bake for 25 minutes or until cheese is lightly browned', 'sprinkle with rest of french fried onions and bake until onions are browned and cheese is bubbly , about 10 more minutes']                                                                                                                                                                                                                                                                                                                              | since there are already 411 recipes for broccoli casserole posted to "zaar" ,i decided to call this one  #412 broccoli casserole.i don't think there are any like this one in the database. i based this one on the famous "green bean casserole" from campbell's soup. but i think mine is better since i don't like cream of mushroom soup.submitted to "zaar" on may 28th,2008 | ['frozen broccoli cuts', 'cream of chicken soup', 'sharp cheddar cheese', 'garlic powder', 'ground black pepper', 'salt', 'milk', 'soy sauce', 'french-fried onions']          |               9 |        5 | I made this for my son's first birthday party this weekend. Our guests INHALED it! Everyone kept saying how delicious it was. I was I could have gotten to try it.                                                                                                                                                                               |            5 |
| 412 broccoli casserole               |      306168 |        40 |     50969 | 2008-05-30 00:00:00 | ['60-minutes-or-less', 'time-to-make', 'course', 'main-ingredient', 'preparation', 'side-dishes', 'vegetables', 'easy', 'beginner-cook', 'broccoli']                                                                        | [np.float64(194.8), np.float64(0.2), np.float64(0.06), np.float64(0.32), np.float64(0.22), np.float64(0.36), np.float64(0.03)]  |         6 | ['preheat oven to 350 degrees', 'spray a 2 quart baking dish with cooking spray , set aside', 'in a large bowl mix together broccoli , soup , one cup of cheese , garlic powder , pepper , salt , milk , 1 cup of french onions , and soy sauce', 'pour into baking dish , sprinkle remaining cheese over top', 'bake for 25 minutes or until cheese is lightly browned', 'sprinkle with rest of french fried onions and bake until onions are browned and cheese is bubbly , about 10 more minutes']                                                                                                                                                                                                                                                                                                                              | since there are already 411 recipes for broccoli casserole posted to "zaar" ,i decided to call this one  #412 broccoli casserole.i don't think there are any like this one in the database. i based this one on the famous "green bean casserole" from campbell's soup. but i think mine is better since i don't like cream of mushroom soup.submitted to "zaar" on may 28th,2008 | ['frozen broccoli cuts', 'cream of chicken soup', 'sharp cheddar cheese', 'garlic powder', 'ground black pepper', 'salt', 'milk', 'soy sauce', 'french-fried onions']          |               9 |        5 | Loved this.  Be sure to completely thaw the broccoli.  I didn&#039;t and it didn&#039;t get done in time specified.  Just cooked it a little longer though and it was perfect.  Thanks Chef.                                                                                                                                                     |            5 |

And, with only the columns cleaned/filtered:

|   rating | date                | nutrition                                                                                                                       | steps                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | ingredients                                                                                                                                                                    |   minutes |
|---------:|:--------------------|:--------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------:|
|        4 | 2008-10-27 00:00:00 | [np.float64(138.4), np.float64(0.1), np.float64(0.5), np.float64(0.03), np.float64(0.03), np.float64(0.19), np.float64(0.06)]   | ['heat the oven to 350f and arrange the rack in the middle', 'line an 8-by-8-inch glass baking dish with aluminum foil', 'combine chocolate and butter in a medium saucepan and cook over medium-low heat , stirring frequently , until evenly melted', 'remove from heat and let cool to room temperature', 'combine eggs , sugar , cocoa powder , vanilla extract , espresso , and salt in a large bowl and briefly stir until just evenly incorporated', 'add cooled chocolate and mix until uniform in color', 'add flour and stir until just incorporated', 'transfer batter to the prepared baking dish', 'bake until a tester inserted in the center of the brownies comes out clean , about 25 to 30 minutes', 'remove from the oven and cool completely before cutting']                                                  | ['bittersweet chocolate', 'unsalted butter', 'eggs', 'granulated sugar', 'unsweetened cocoa powder', 'vanilla extract', 'brewed espresso', 'kosher salt', 'all-purpose flour'] |        40 |
|        5 | 2011-04-11 00:00:00 | [np.float64(595.1), np.float64(0.46), np.float64(2.11), np.float64(0.22), np.float64(0.13), np.float64(0.51), np.float64(0.26)] | ['pre-heat oven the 350 degrees f', 'in a mixing bowl , sift together the flours and baking powder', 'set aside', 'in another mixing bowl , blend together the sugars , margarine , and salt until light and fluffy', 'add the eggs , water , and vanilla to the margarine / sugar mixture and mix together until well combined', 'add in the flour mixture to the wet ingredients and blend until combined', 'scrape down the sides of the bowl and add the chocolate chips', 'mix until combined', 'scrape down the sides to the bowl again', 'using an ice cream scoop , scoop evenly rounded balls of dough and place of cookie sheet about 1 - 2 inches apart to allow for spreading during baking', 'bake for 10 - 15 minutes or until golden brown on the outside and soft & chewy in the center', 'serve hot and enjoy !'] | ['white sugar', 'brown sugar', 'salt', 'margarine', 'eggs', 'vanilla', 'water', 'all-purpose flour', 'whole wheat flour', 'baking soda', 'chocolate chips']                    |        45 |
|        5 | 2008-05-30 00:00:00 | [np.float64(194.8), np.float64(0.2), np.float64(0.06), np.float64(0.32), np.float64(0.22), np.float64(0.36), np.float64(0.03)]  | ['preheat oven to 350 degrees', 'spray a 2 quart baking dish with cooking spray , set aside', 'in a large bowl mix together broccoli , soup , one cup of cheese , garlic powder , pepper , salt , milk , 1 cup of french onions , and soy sauce', 'pour into baking dish , sprinkle remaining cheese over top', 'bake for 25 minutes or until cheese is lightly browned', 'sprinkle with rest of french fried onions and bake until onions are browned and cheese is bubbly , about 10 more minutes']                                                                                                                                                                                                                                                                                                                              | ['frozen broccoli cuts', 'cream of chicken soup', 'sharp cheddar cheese', 'garlic powder', 'ground black pepper', 'salt', 'milk', 'soy sauce', 'french-fried onions']          |        40 |
|        5 | 2008-05-30 00:00:00 | [np.float64(194.8), np.float64(0.2), np.float64(0.06), np.float64(0.32), np.float64(0.22), np.float64(0.36), np.float64(0.03)]  | ['preheat oven to 350 degrees', 'spray a 2 quart baking dish with cooking spray , set aside', 'in a large bowl mix together broccoli , soup , one cup of cheese , garlic powder , pepper , salt , milk , 1 cup of french onions , and soy sauce', 'pour into baking dish , sprinkle remaining cheese over top', 'bake for 25 minutes or until cheese is lightly browned', 'sprinkle with rest of french fried onions and bake until onions are browned and cheese is bubbly , about 10 more minutes']                                                                                                                                                                                                                                                                                                                              | ['frozen broccoli cuts', 'cream of chicken soup', 'sharp cheddar cheese', 'garlic powder', 'ground black pepper', 'salt', 'milk', 'soy sauce', 'french-fried onions']          |        40 |
|        5 | 2008-05-30 00:00:00 | [np.float64(194.8), np.float64(0.2), np.float64(0.06), np.float64(0.32), np.float64(0.22), np.float64(0.36), np.float64(0.03)]  | ['preheat oven to 350 degrees', 'spray a 2 quart baking dish with cooking spray , set aside', 'in a large bowl mix together broccoli , soup , one cup of cheese , garlic powder , pepper , salt , milk , 1 cup of french onions , and soy sauce', 'pour into baking dish , sprinkle remaining cheese over top', 'bake for 25 minutes or until cheese is lightly browned', 'sprinkle with rest of french fried onions and bake until onions are browned and cheese is bubbly , about 10 more minutes']                                                                                                                                                                                                                                                                                                                              | ['frozen broccoli cuts', 'cream of chicken soup', 'sharp cheddar cheese', 'garlic powder', 'ground black pepper', 'salt', 'milk', 'soy sauce', 'french-fried onions']          |        40 |
